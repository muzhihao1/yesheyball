# 前端改造落地方案（问题拆解 + 第一性原理）

> 对每个问题：明确本质与目标 → 给最佳可执行方案（含比原文更优的做法） → 给开发顺序。现有代码路径均已核实。

## P0（阻断留存/引导）

### 1. 新手引导缺失：用户不知道从哪里开始
- 本质：0→1 路径缺口，缺少信息减速带（价值、承诺、行动顺序）与分层起步（水平评估）。
- 目标：首访 2 分钟内完成理解价值、3-5 题水平测试、拿到“接下来 3 天计划”并开练。
- 方案（优于弹窗的页级引导）：
  - 新路由 `/onboarding`：登录/注册成功且未完成引导时强制跳转，完成后写标记（后端字段 + localStorage 双保险）。
  - 流程：① 欢迎/痛点共鸣（时间少、练了没反馈）+ 承诺（90 天清台）；② 3-5 题水平测试（准度/走位/练球频次/是否有基础，滑条+单选）；③ 算法产出起始天数 + 初始能力；④ 结果页给“接下来 3 天计划卡”（含预计用时/主题）+ “开始第 1 天”按钮。
  - 数据：将起始日、初始分存后端（扩展 `user_ninety_day_progress` 或新表），防止只靠前端标记。

### 2. 首屏价值与流程不清：不知道为什么/怎么练
- 本质：首屏未回答“做什么、多久、凭什么有效”。
- 目标：3 秒识别价值，10 秒看到行动路径。
- 方案（挑战页 Hero 重构）：
  - 文案：主标题“用 90 天，从新手到一杆清台”；副标题“每天 30 分钟，已有 1000+ 新手完成清台”；主按钮“免费开始我的训练”。
  - 视觉：Hero 真实台球场景图；右侧/下方里程碑进度条（基础/进阶/实战三段，显示剩余天数与今日预计用时）。
  - “如何开始”三步：水平测试 → 获取计划 → 完成今日训练（含跳转按钮）。

### 3. 日常任务/连胜提醒缺失：缺少日回访拉力
- 本质：缺少日常触发点与损失厌恶提醒。
- 目标：每天有 3 个可完成的小任务，未训练有断档提醒。
- 方案：
  - 将 `DailyGoalsPanel` 直接嵌入挑战页 Hero 下方；完成后给 XP/提示。
  - 顶部头像旁加连胜火焰：今天未训练灰色提示“今天还没训练，别断档”，完成后高亮。
  - 数据沿用 `/api/goals/daily` + 用户 streak。

### 4. 社交分享与邀请缺位：缺少增长/社交激励
- 本质：没有外部动力和社交参照。
- 目标：每次训练可分享，用户能邀请好友，入口显眼。
- 方案（聚焦 MVP）：
  - 训练完成弹窗新增“分享成绩”：用 html2canvas 生成卡片（头像/用户名/时长/星级/能力提升）；优先 Web Share，失败提示“长按保存”。
  - “我的”页新增“邀请好友”卡：展示邀请链接/二维码 + 奖励规则（双方 XP/徽章），后端记录关系。
  - 在导航或挑战页添加排行榜入口（复用 `ranking.tsx`），至少周榜。

### 5. 训练记录体验原始：输入摩擦高、错填不可改
- 本质：表单成本高，错误不可逆。
- 目标：低摩擦填写，可修正最近一次。
- 方案：
  - `TrainingForm` 增预设按钮（如 10/5、20/10、30/15）、滑条输入、实时校验成功 ≤ 总次数，提示改为友好语气。
  - 增“最近一次记录”卡片，提供编辑/撤销（需要后端 PATCH/DELETE ninenty-day record API 支持）。

### 6. 首次完成引导/注册后无短期计划
- 本质：缺少“下一步做什么”的短期锚点。
- 目标：登录/引导完成后直接看到 3 天计划并可点击。
- 方案：
  - 登录/注册成功且未开始挑战：展示 day1-3 计划卡（标题/预计用时/进入按钮），CTA 直达当日训练。
  - 同样卡片复用在 `/onboarding` 结果页，体验一致。

## P1（闭环与定位）

### 7. 学习闭环缺口：数据 → 行动断裂
- 本质：能力数据不指向行动，空态浪费。
- 目标：弱项一键去练，空态促首练。
- 方案：
  - `profile.tsx` 增“弱项推荐”卡：自动选最低维度，提供“去专项训练”（跳 `tasks.tsx` 对应模块）和“去完成今日训练”两个 CTA。
  - `TrainingTrendChart` 空态改为 CTA：“完成第一次训练，解锁成长曲线” → 挑战页。

### 8. 技能库定位混淆：主线/辅线不清
- 本质：理论/专项/日常目标堆叠，主线挑战弱化。
- 目标：明确“挑战是主线，技能库用于复习/突破”。
- 方案：
  - `tasks.tsx` 顶部加 Tab/折叠：理论学习 vs 专项训练；日常目标保留但提示“主线在挑战页，完成后再来复习/突破”。
  - 登录默认落地 `/ninety-day-challenge`，导航顺序保持挑战优先。

### 9. 排行入口缺省：社交参照弱
- 方案：底部导航新增“排行榜”或挑战页右上角入口，周榜为空时提示“邀请好友占位”并复用邀请链接。

## P2（加分项）

### 10. 5 分钟快速训练
- 挑战页“今日训练”下提供 5-8 分钟精简版，计入 streak/XP，权重低于正式训练，降低时间门槛。

### 11. 90 天全景/里程碑强化
- AdventureMap 增阶段配色与 30/60/90 里程碑；ProgressOverviewModal 增证书占位与分享按钮。

### 12. 性能与空态
- 首屏字体/图标 preload，非首屏组件懒加载；空态统一提供 CTA。

## 开发顺序（里程碑）
1) P0-1：`/onboarding` 流程 + 路由强制/登录落地调整 + 3 日计划卡（登录/结果页共用）。  
2) P0-2：挑战页 Hero 重构（价值/里程碑/真实图/三步）+ 日常任务/连胜植入。  
3) P0-3：训练完成分享卡 + 邀请好友卡 + 导航/挑战页增加排行榜入口。  
4) P0-4：`TrainingForm` 预设/滑条/友好提示 + 最近记录可编辑（配后端 API）。  
5) P1-1：能力闭环（弱项推荐、趋势空态 CTA）。  
6) P1-2：技能库 Tab 化与主线提示。  
7) P2：快速训练、里程碑视觉、性能/空态优化。

> 确认顺序后，我先落地 P0-1 的路由与页面骨架，再补交互与样式细节。 
