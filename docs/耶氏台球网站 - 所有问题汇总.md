# 耶氏台球网站 - 所有问题汇总

## 一、技能库页面布局问题

### 问题1: 技能库页面内容顺序不合理（P1级）

**问题描述**：
用户明确表示技能库应该"以实践为主"，但当前页面的内容顺序是：
1. 每日目标
2. 傅家俊十大招系统训练（理论学习）
3. 专项训练道场（实践训练）

这个顺序让用户进入技能库后，首先看到的是理论学习内容，而不是实践训练，与产品定位不符。

**修改建议**：
调整技能库页面的内容顺序为：
1. 顶部说明区域（保持不变）
2. **专项训练道场**（上移到十大招的上面）
3. 每日目标
4. 傅家俊十大招系统训练

**涉及文件**：
- `client/src/pages/Tasks.tsx`

**优先级**：P1（上线后优先优化）

---

## 二、技能库功能性问题（P0级 - 必须立即修复）

### 问题2: 点击道场卡片时页面跳转错误（P0级）

**问题描述**：
在技能库主页，点击"发力训练营"卡片时，页面跳转到了"第一招：基本功"的子技能列表页面，而不是"发力训练营"的训练计划列表。

这说明道场卡片的点击事件绑定错误，或者路由逻辑有问题。

**测试记录**：
- 点击"基本功道场"→ 正确跳转到"基本功道场"的训练计划列表
- 点击"发力训练营"→ 错误跳转到"第一招：基本功"的子技能列表

**修改建议**：
检查并修复道场卡片的点击事件处理逻辑，确保：
1. 点击道场卡片时，正确跳转到对应道场的训练计划列表
2. 道场卡片的路由参数正确传递

**涉及文件**：
- `client/src/pages/Tasks.tsx`（道场卡片的点击事件）
- `client/src/pages/TaskDetail.tsx`（训练计划列表页面）

**优先级**：P0（必须立即修复）

---

### 问题3: 训练对话框无法正常关闭（P0级）

**问题描述**：
在"基本功道场"的训练计划列表页面，点击"站位与重心控制基础"→"开始训练"后，训练计时器正常启动。但是当用户点击页面空白区域尝试关闭训练对话框时，对话框没有关闭，反而页面跳转到了"第一招：基本功"的子技能列表页面。

更严重的是，训练对话框会持续存在，即使点击"返回技能列表"按钮返回技能库主页，训练对话框仍然显示在页面底部，无法关闭。

**测试记录**：
1. 在"基本功道场"→"站位与重心控制基础"→"开始训练"
2. 点击页面空白区域 → 页面跳转到"第一招：基本功"，但训练对话框仍然存在
3. 点击"返回技能列表" → 返回技能库主页，但训练对话框仍然存在

**修改建议**：
1. 修复训练对话框的关闭逻辑，确保点击空白区域或关闭按钮时，对话框能正常关闭
2. 修复页面跳转逻辑，确保关闭训练对话框时，页面不会发生错误跳转
3. 确保训练对话框的状态管理正确，避免对话框在不同页面间持续存在

**涉及文件**：
- `client/src/components/TrainingDialog.tsx`（训练对话框组件）
- `client/src/pages/TaskDetail.tsx`（训练详情页面）

**优先级**：P0（必须立即修复）

---

### 问题4: 点击"开始训练"后页面跳转逻辑混乱（P0级）

**问题描述**：
在"发力训练营"→"直线球瞄准基础"训练详情页面，点击"开始训练"按钮后，页面没有停留在训练详情页，而是跳转回了技能库主页。

同时，页面底部出现了两个UI元素：
1. 训练对话框（显示计时器、暂停、结束训练按钮）
2. 浮动按钮（显示"开始训练"）

这两个元素功能重复，且会相互遮挡，用户体验非常差。

**期望行为**：
点击"开始训练"后，页面应该停留在训练详情页，只显示训练对话框，不应该跳转回技能库主页，也不应该出现重复的浮动按钮。

**修改建议**：
1. 修复"开始训练"按钮的点击逻辑，确保页面停留在训练详情页
2. 移除重复的浮动按钮，或者明确区分训练对话框和浮动按钮的使用场景
3. 确保训练状态管理正确，避免UI元素重复出现

**涉及文件**：
- `client/src/pages/TaskDetail.tsx`（训练详情页面）
- `client/src/components/TrainingDialog.tsx`（训练对话框组件）

**优先级**：P0（必须立即修复）

---

### 问题5: 训练时长显示单位错误（P1级）

**问题描述**：
完成训练并提交评价后，"训练完成！"对话框显示的训练时长单位错误。

**测试数据**：
- 实际训练时长：1分31秒（91秒）
- 显示的训练时长：91分

**问题分析**：
系统将秒数直接显示为分钟数，单位转换错误。应该显示"91秒"或"1分31秒"，而不是"91分"。

**修改建议**：
修复训练时长的显示逻辑，正确转换单位：
- 如果训练时长小于60秒，显示"XX秒"
- 如果训练时长大于等于60秒，显示"X分XX秒"

**涉及文件**：
- `client/src/components/TrainingCompletionDialog.tsx`（训练完成对话框）

**优先级**：P1（上线后优先优化）

---

### 问题6: 每日目标进度不更新（P0级）

**问题描述**：
完成训练并提交5星评价后，技能库主页的"每日目标"进度没有任何变化。

**测试数据**：
- 完成训练前：
  - "完成 1 次训练"：0/1次 0%
  - "完成1次评分达到 4 星的训练"：0/4星 0%
  - "完成1次评分达到 5 星的训练"：0/5星 0%
- 完成训练并提交5星评价后：
  - "完成 1 次训练"：仍然显示 0/1次 0%
  - "完成1次评分达到 4 星的训练"：仍然显示 0/4星 0%
  - "完成1次评分达到 5 星的训练"：仍然显示 0/5星 0%

**问题分析**：
这是一个严重的数据同步问题。用户完成训练后，每日目标的进度没有更新，会严重影响用户的激励体验，让用户感到困惑和沮丧。

**修改建议**：
1. 检查训练完成后的数据提交逻辑，确保训练记录正确保存到数据库
2. 检查每日目标的数据查询逻辑，确保能正确统计当天的训练记录
3. 确保训练完成后，页面能自动刷新或重新获取每日目标的进度数据

**涉及文件**：
- `server/routes/training.ts`（训练记录保存接口）
- `client/src/pages/Tasks.tsx`（每日目标数据获取）
- `client/src/components/DailyGoals.tsx`（每日目标组件）

**优先级**：P0（必须立即修复）

---

## 三、问题优先级总结

### P0级问题（必须立即修复，否则无法上线）：
1. **问题2**：点击道场卡片时页面跳转错误
2. **问题3**：训练对话框无法正常关闭
3. **问题4**：点击"开始训练"后页面跳转逻辑混乱
4. **问题6**：每日目标进度不更新

### P1级问题（上线后优先优化）：
1. **问题1**：技能库页面内容顺序不合理
2. **问题5**：训练时长显示单位错误

---

## 四、修复建议的优先顺序

建议按照以下顺序修复问题：

1. **第一优先级**：修复问题3和问题4（训练对话框和页面跳转逻辑）
   - 这两个问题相互关联，应该一起修复
   - 这是用户体验的核心问题，严重影响训练功能的可用性

2. **第二优先级**：修复问题6（每日目标进度不更新）
   - 这是激励系统的核心问题，严重影响用户的成就感

3. **第三优先级**：修复问题2（道场卡片跳转错误）
   - 这是导航逻辑问题，影响用户找到正确的训练内容

4. **第四优先级**：修复问题1（页面内容顺序）
   - 这是产品定位问题，影响用户对产品的理解

5. **第五优先级**：修复问题5（训练时长显示单位）
   - 这是显示问题，不影响核心功能

---

## 五、测试建议

在修复上述问题后，建议进行以下全面测试：

1. **专项训练道场测试**：
   - 逐一测试所有8个专项训练道场的完整流程
   - 验证道场卡片点击 → 训练计划列表 → 训练详情 → 开始训练 → 完成训练的完整流程

2. **十大招系统测试**：
   - 逐一测试所有10招的完整流程
   - 验证招式卡片点击 → 子技能列表 → 子技能详情 → 开始训练 → 完成训练的完整流程

3. **每日目标测试**：
   - 验证完成不同星级的训练后，每日目标进度是否正确更新
   - 验证完成所有每日目标后，是否有相应的奖励和反馈

4. **跨页面状态测试**：
   - 验证在不同页面间切换时，训练状态是否正确保持或清除
   - 验证训练对话框在不同页面间的显示和隐藏逻辑

