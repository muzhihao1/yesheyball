# Quick Testing Guide - Critical Path Validation

**目标**: 快速验证核心功能是否正常工作
**预计时间**: 15-20 分钟
**前置条件**: 代码已部署到 Vercel 生产环境

---

## ⚡ 快速验证清单

### Step 1: 数据库初始化 (只需执行一次)

```bash
# 1. 初始化成就模板 (20个成就)
curl -X POST https://your-production-url.vercel.app/api/admin/init-achievements

# 预期响应:
# { "inserted": 20, "message": "Successfully initialized 20 achievements" }

# 2. 初始化每日目标模板 (8个目标模板)
curl -X POST https://your-production-url.vercel.app/api/admin/init-goal-templates

# 预期响应:
# { "inserted": 8, "message": "Successfully initialized 8 goal templates" }
```

### Step 2: 核心功能测试 (约10分钟)

#### 测试场景 1: 新用户首次训练 ✅ 必测
1. **登录系统**
   - [ ] 使用测试账号或注册新账号
   - [ ] 成功进入主界面

2. **查看每日目标**
   - [ ] 进入 Levels 页面
   - [ ] 看到"每日目标"面板
   - [ ] 显示3个目标 (1个简单 + 1个中等 + 1个困难)
   - [ ] 所有目标进度为 0%

3. **完成首次训练**
   - [ ] 选择任意训练项目
   - [ ] 开始训练
   - [ ] 完成训练 (任意时长)
   - [ ] 评分: 5星

4. **验证成就解锁**
   - [ ] 看到庆祝动画 (confetti)
   - [ ] AI 反馈弹窗出现
   - [ ] 关闭 AI 反馈后
   - [ ] **成就解锁弹窗**出现
   - [ ] 显示 "第一滴血" 成就
   - [ ] 显示奖励: +10 EXP

5. **验证每日目标更新**
   - [ ] 返回 Levels 页面
   - [ ] 每日目标面板自动刷新
   - [ ] 至少一个目标进度 > 0%
   - [ ] 进度条平滑动画显示

6. **验证经验值增加**
   - [ ] 查看用户等级/经验条
   - [ ] 经验值应该增加:
     - 训练基础经验
     - 成就奖励 +10 EXP
     - 可能的目标完成奖励

---

#### 测试场景 2: 完成每日目标 ⭐ 推荐测试

1. **连续完成2-3次训练**
   - [ ] 每次训练后查看目标进度
   - [ ] 验证进度累加正确

2. **完成所有3个目标**
   - [ ] 当最后一个目标达到100%
   - [ ] 看到绿色完成消息
   - [ ] 消息内容: "🎉 今日目标已全部完成！明天继续加油！"

3. **验证奖励发放**
   - [ ] 每完成一个目标立即获得经验
   - [ ] 总经验增加 = 训练经验 + 3个目标奖励 (10+20+30 = 60 EXP)

---

#### 测试场景 3: 数据持久化 🔒 必测

1. **刷新页面**
   - [ ] 按 F5 或 Cmd+R 刷新浏览器
   - [ ] 每日目标进度保持不变
   - [ ] 已解锁成就仍然显示为已解锁
   - [ ] 经验值/等级保持不变

2. **重新登录**
   - [ ] 退出登录
   - [ ] 重新登录
   - [ ] 数据完整保留

---

## 🚨 关键验证点

### Must-Have Features (必须正常工作)
- [x] 每日目标自动生成 (3个)
- [x] 训练完成后目标进度更新
- [x] 首次训练解锁"第一滴血"成就
- [x] 成就弹窗显示 + 动画
- [x] 经验值正确增加
- [x] 数据刷新后保持

### Nice-to-Have Features (可以有小问题)
- [ ] 动画流畅 (60fps)
- [ ] 响应速度 < 1秒
- [ ] 移动端适配
- [ ] 错误提示友好

---

## 📊 快速测试结果模板

**测试时间**: _________
**测试环境**: Vercel Production
**测试账号**: _________

| 功能模块 | 状态 | 备注 |
|---------|------|------|
| 每日目标生成 | ☐ 通过 / ☐ 失败 |  |
| 目标进度追踪 | ☐ 通过 / ☐ 失败 |  |
| 成就解锁 | ☐ 通过 / ☐ 失败 |  |
| 经验值奖励 | ☐ 通过 / ☐ 失败 |  |
| 数据持久化 | ☐ 通过 / ☐ 失败 |  |

**发现的问题**:
1. ___________________________
2. ___________________________

**整体评价**: ☐ 可以上线 / ☐ 需要修复

---

## 🐛 常见问题排查

### 问题 1: 每日目标不显示
**可能原因**:
- 数据库未初始化目标模板
- API 请求失败

**解决方法**:
1. 检查浏览器控制台 (F12) → Network 标签
2. 查看 `/api/goals/daily` 请求状态
3. 如果 404/500,重新运行初始化脚本

### 问题 2: 成就不解锁
**可能原因**:
- 数据库未初始化成就数据
- 用户已经解锁过

**解决方法**:
1. 检查 `/api/check-achievements` API 调用
2. 验证数据库中 `achievements` 表有数据
3. 使用新测试账号重试

### 问题 3: 进度不更新
**可能原因**:
- React Query 缓存未失效
- API 调用失败

**解决方法**:
1. 硬刷新页面 (Ctrl+Shift+R)
2. 检查 Network 标签的 API 调用
3. 验证服务器日志

---

## 📞 需要帮助?

如果遇到问题:
1. 查看浏览器控制台错误
2. 查看 Vercel Functions 日志
3. 检查数据库连接状态
4. 参考 `docs/deployment_verification.md` 完整清单

**紧急联系**: Project Owner
**技术文档**: `docs/testing_report.md`
